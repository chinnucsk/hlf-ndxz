// 
// The Master Stylesheet
// =====================
// Styles specified here should be consistent for all media.

// Layout
// ======

// These are css imports and need to go first.
@import 'layout_screen.css' screen;
@import 'layout_mobile.css' handheld;
@import 'layout_print.css' print;

// Constants
// =========

$_clr-accent-1: #05c;
$_clr-accent-2: #07e;
$_clr-accent-3: #06c;
$_clr-accent-4: #06f;
$_clr-light-1: #fff;
$_clr-light-2: #eaeaea;
$_clr-light-3: #f4f4f4;
$_clr-light-4: #f0f0f0;
$_clr-light-5: #dadad8;
$_clr-shade-1: #000;
$_clr-shade-2: #333;
$_clr-base-1: #aaa;
$_clr-base-2: #606060;
$_clr-base-3: #999;
$_clr-base-4: #ccc;

$_img: '../img/';

// Base
// ====

// Add context-dependent base boilerplate. Utility classes are also added.
$_context: master;
@import "../scss/bootstrap.scss";
//
// Object oriented internal classes to extend from.
._accented-menu-item-1 {
  border-left-color: $_clr-accent-1;
  &:hover { border-left-color: $_clr-accent-2; }
}
._accented-menu-item-2 {
  border-left-color: transparent;
  &:hover { border-left-color: $_clr-accent-2; }
}
._toggled-menu-item-1 {
  background-color: $_clr-light-1;
}
._base-text-1 {
  color: $_clr-shade-2;
}
._base-text-2 {
  color: $_clr-base-2;
}
._heavy-text-1 {
  color: $_clr-shade-1;
}
._meta-text-1 {
  color: $_clr-base-1;
}
._meta-text-2 {
  color: $_clr-base-3;
}
._meta-text-3 {
  color: $_clr-base-4;
}
._meta-text-4 {
  color: $_clr-light-5;
}
._meta-text-5 {
  color: $_clr-light-2;
}
._underlined-text-1 {
  border-bottom: 1px dotted ($_clr-base-1 + $hx);
  &.truncated { border-bottom: 0; }
}
._link-text-1 {
  border-bottom: 1px dotted transparent;
  @include transition(color border-bottom-color);
  &:link, &:active, &:visited {color: $_clr-accent-3; }
  &:hover {
    color: $_clr-accent-4;
    border-bottom-color: $_clr-base-1;
  }
}
._meta-link-text-1 {
  // Includes necessary reset.
  &, &:hover { color: $_clr-shade-2; }
}
._meta-link-text-2 {
  color: $_clr-base-1;
  // Includes necessary reset.
  &:hover { color: $_clr-shade-2; }
}
._meta-link-text-3 {
  color: $_clr-base-2;
  // Includes necessary reset.
  &:hover { color: $_clr-shade-2; }
}
._ribbon-text-1 {
  $bg-color: $_clr-light-3;
  $inset-size: 4px;
  @include single-inset(0, -1px, $inset-size, $b-1);
  background-color: $bg-color;
  html.boxshadow & {
    margin-left: -$inset-size;
    padding-left: $inset-size;
    border: {
      width: 1px;
      color: $bg-color ($bg-color - $hx) ($bg-color - 2*$hx) ($bg-color - $hx);
      style: solid;
    }
  }
}
._floating-text-1 {
  text-shadow: 0 1px 0 $b-2;
}
._engraved-text-1 {
  @include text-inset;
}
._selected-text-1 {
  background: transparent;
  color: $_clr-shade-1;
  text-shadow: none;
}
._button-1-default {
  $bg-color: $_clr-light-4;
  @include simple-bevel($b-2, $w-3, 4px, 2px, 0, 0);
  @include transition(background-color border-color color, 0.3s);
  background-color: $bg-color;
  border-color: $bg-color + 0.5*$hx;
}
._button-1-toggled {
  background-color: $_clr-light-3;
  border-color: $_clr-light-1;
}
._paper-1 {
  $bg-color: $_clr-light-1;
  @include simple-bevel($b-1, $b-3, 1em, 3px, 0, 0);
  background-color: $bg-color;
  html.boxshadow & { border: 1px solid $bg-color; }
}
._paper-2 {
  $bg-color: $_clr-light-2;
  @include simple-bevel($w-2, $b-1, 2em, 3px, 1px, 0, -1em, 0);
  background-color: $bg-color;
  html.boxshadow & { border: 1px solid $bg-color; border-left: 0; }
}
._paper-3 {
  $bg-color: $_clr-light-3;
  @include simple-bevel($w-2, $b-2, 2em, 3px, 1px, 0, -1em, 0);
  background-color: $bg-color;
  html.boxshadow & { border: 1px solid $bg-color; border-left: 0; }
}
//
// Extended boilerplate.
::selection, ::-moz-selection { @extend ._selected-text-1; }
a:link { -webkit-tap-highlight-color: $_clr-light-5; }

body {
  @extend ._base-text-1;
  cursor: default;
}

select, input, textarea {
  @extend ._base-text-1;
}

abbr, strong {
  @extend ._heavy-text-1;
}

a {
  @extend ._link-text-1;
  // Reset.
  h3 & { 
    @extend ._meta-link-text-1;
    &.as { @extend ._meta-link-text-3; }
  }
  &.compound {
    @extend ._meta-link-text-1;
    .faux-link { @extend ._link-text-1; }
    article {
      * { @extend ._meta-text-1; }
      .tags { @extend ._meta-text-3; }
    }
  }
}

// Modules
// =======

.mn {
  ol, ul {
    border: { style: solid; color: $_clr-light-4; }
  }
  li {
    border: { style: solid; color: $_clr-light-2; }
  }
}

// Extensions & Plugins
// ====================

.container {
  .rows dt {
    @extend ._meta-text-2;
    // Reset.
    #{$_weight} & {
      @include box-shadow(none);
      background-color: transparent;
      border: 0;
    }
  }
}

.section-title {
  @extend ._floating-text-1;
  .title { @extend ._underlined-text-1; }
}

#{$_weight} .js-fold-trigger {
  // Reset.
  & { @extend ._meta-text-1; }
  &:not(.js-fold-disabled) { @extend ._meta-link-text-2; }
}

.feed {
  article .meta * { @extend ._meta-text-1; }
}

sup {
  #{$_weight} & { text-shadow: none; } // Reset.
  .hdr & {
    @extend ._meta-text-5;
  }
  .h-main & {
    #menu & { @extend ._meta-text-4; }
  }
}
// App
// ===

// Colors
// ------
// Text and box colors and effects.
#menu {
  // - Folds.
  .js-fold-trigger {
    @extend ._button-1-default;
    &:not(.js-fold-disabled):hover { @extend ._button-1-toggled; }
    &.js-fold-disabled { cursor: default; }
  }
  .js-foldables a:not(.js-fold-trigger):hover { @extend ._toggled-menu-item-1; }
  // - Menus.
  .mn-v {
    @extend ._paper-3;
    a {
      @extend ._engraved-text-1;
      @include transition(background-color border-color, 0.2s);
      border-left-color: transparent;
    }
    li.active a { @extend ._accented-menu-item-1; }
    .ie7 & li a {
      background-color: $_clr-light-3;
      :hover { border-left-color: $_clr-light-1; }
    }
  }
  // - Other.
  #hd .in { @extend ._paper-1; }
  #ft .in { @extend ._paper-2; }
}

#content {
  // - Feed.
  .feed {
    a { @extend ._accented-menu-item-2; }
  }
  // - Box.
  .box {
    h3 { @extend ._floating-text-1; }
    .in {
      @extend ._paper-1;
      .delim { @extend ._meta-text-5; }
    }
  }
  // - Text.
  .abbr { @extend ._underlined-text-1; }
  p {
    @extend ._paper-1;
    // Reset.
    html.boxshadow & {
      &.scroll-item, &.embed {
        border: 0;
        padding: 0;
      }
    }
    &.embed { background-color: transparent; } // Reset.
  }
  header .label {
    @extend ._ribbon-text-1;
    @extend ._floating-text-1;
  }
  li.label {
    @extend ._ribbon-text-1;
    @extend ._floating-text-1;
  }
  dt { @extend ._ribbon-text-1; }
  h3 .as { text-shadow: none; } // Reset.
}

// Images
// ------
// Sprites, other very custom, one-off stuff.
#logo {
  $height: 48px;
  padding: 17px 0 0 3px;
  line-height: 0;
  a {
    @extend .inline-block;
    @extend .sprite;
    background: { color: $_clr-light-1; image: url(#{$_img}banners_logo_ro.jpg); }
    height: $height;
    width: 225px;
    &:hover { background-position: 0 (-$height + 1px); }
  }
  
}
#ou-intro {
  $width-with-gutter: 240px;
  .in {
    @include min-height(300px);
    @extend .sprite;
    background: { color: $_clr-light-1; image: url(#{$_img}banner_about.png); position: bottom right; }
  }
  #intro {
    padding: { top: 0.8em; bottom: 1em; }
  }
  #intro, #tagline { padding-right: $width-with-gutter; }
}
body {
  background: $_clr-light-5 url(#{$_img}bg_space_tile.jpg) 0 0 repeat-x fixed; 
}
#menu,
#content {
  background: transparent url(#{$_img}banners/env1_1.jpg) 0 0 repeat-x fixed;
}

/** hlf-tip */
.pjpTipStem,
._ { border-right-color: transparent; }

.pjpTipStem,
._ { border-bottom-color: #606060; }

.pjpTip .in,
._ { background-color: #606060; }

.pjpTip .in,
._ { color: #fff; }

/* hlf tip **/

/**
 * The Typography styleheet
 * @see     readme.txt
 * @author    peng@pengxwang.com
**/
/** global > style */

.pjpTip,
#menu, 
#content 
{ text-align: left; }

.null
{ text-align: right; }
/*
#content dd,
#content p
{ text-align: justify; }
*/
.pjpTip,
#colophon *,
.section-title,
h1, h2, h3
{ text-transform: lowercase; }

.copy small
{ text-transform: uppercase; }

#html h1, #html h2, #html h3, 
/* _ref font-family */
#html strong { font-weight: bold; }

.pjpTip,
.caption,
#html em { font-style: italic;}

.null
{ font-style: normal; }

#html em strong
{ font-weight: normal; }

.hd .as,
#html em *,
#html em { letter-spacing: normal; }

.hd .as
{ word-spacing: normal; }

a.compound:hover,
#navigation a:hover,
a 
{ text-decoration: none; }

/* ^ global > style **/
/** global > size + spacing */

.copy small
{ font-size: .5em; /* 8px */}
  .copy small { /* uppercase */
    letter-spacing: .125em; /* 1px */
    word-spacing: .25em; /* 2px */
  }
  .copy dt small
  {
    line-height: 3em; /* align 24px */
  }
.pjpTip,
.slideshow-plugin .meta .caption,
#colophon
{ font-size: .5625em; /* 9px */ }
  .pjpTip,
  .slideshow-plugin .meta .caption,
  #colophon 
  { line-height: 1.555em; /* 14px */ }

#content .as,
.slideshow-plugin .meta .title,
.container .rows dt,
.container dd,
.container p,
.container li,
.prose { font-size: .6875em; /* 11px */ }
  .container .mn-v-a a,
  .slideshow-plugin .meta .title,
  .container .rows dt,
  .container dd,
  .container .copy li
  { line-height: 1.455em; /* 16px */ }
  .container p,
  .prose 
  { line-height: 1.636em; /* 18px */ }
  #content header .label,
  #content li.label em
  { line-height: 2.182em; /* 24px */ }

#content dt em
{ font-size: .75em; /* 12px */ }
  #content dt em 
  { line-height: 2em; }

.null
{ font-size: 1em; /* 16px */ }
  h3#intro
  { line-height: 1.25em; }

h2
{ font-size: 1.5em; /* 24px */ }

.null
{ font-size: 1.625em; /* 26px */ }

h1
{ font-size: 1.875em; /* 30px */ }

.null
{ font-size: 2em; /* 32px */ }

/** global > size + spacing > reset */

.container .mn-v-a li,
h1, h2, h3,
a 
{ line-height: 1em; }

.copy dd a, .copy li a,
.prose a
{ line-height: inherit; }

.slideshow-plugin p.meta,
#html .section-title,
#html li li
{ font-size: 1em; }

body.safari,
body.chrome {
  font-size: 16px;
}

/* ^ global > size + spacing > reset **/
/* ^ global > size + spacing **/
/** mono set */

#content .as,
.container,
.mono { font-family: 'Consolas', 'Monaco', 'Lucida Console', 'Andale Mono', monospace !important; }

/* ^ mono set **/
/** serif set */

.pjpTip,
.caption,
#html em *,
#html em,
.serif { font-family: Georgia, 'Constantia', 'Utopian', 'Palatino', 'Palatino Linotype', serif; }


/* ^ serif set **/
/** sans-serif set */

/* default */
body, 
/* utility */
.sans { font-family: Arial, Helvetica, 'Helvetica Neue', sans-serif; } /* reset */

.section-title,
#html h1, #html h2, #html h3,
/* utility */
.hSans {
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  font-weight: bold;
  letter-spacing: -.05em;
  word-spacing: .05em;
}

.copy small,
/* utility */
.wSans { font-family: Verdana, 'Century Gothic', 'Geneva', sans-serif; }

/* utility */
.pSans { font-family: 'Lucida Grande', 'Lucida Sans Unicode', 'Helvetica Neue', Helvetica, Arial, sans-serif; }

/* utility */
.pSans strong { font-family: 'Lucida Grande', 'Lucida Sans Unicode', 'Helvetica Neue', Helvetica, Arial, sans-serif; }

/* ^ sans-serif set **/
///** START IE */

html.ie6 {
  
  // Indexhibit protected.
  img.png {
    background-image: expression(
      this.runtimeStyle.backgroundImage = "none",
      this.runtimeStyle.filter =
      "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + this.src +
      "', sizingMethod='image')",
      this.src = "/path/to/transparent.gif"
    );
  }
  #menu {
    position: absolute;
  }
  .thumb-it {
    top: 50%;
  }
  
  // Give has-layout.
  .has-as,
  .pjpTip .in
  { zoom: 1; }

  // Fix transparent borders.
  .pjpTipStem
  { border-right-color: orange; }

  #html #menu .js-fold-trigger 
  { border-color: orange; }

  .pjpTipStem,
  #html #menu .js-fold-trigger 
  { filter: chroma(color=orange); }
  
  // Debugging.
  .dev { border: 1px solid red; }
  
}

html.ie7 {
  
  // Give has-layout.
  #content .rows
  { zoom: 1; }
  
  // Fix inline-block.
  #logo a { display: inline; display: block; }
  
}

///* END    IE **/